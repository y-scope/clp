version: "3"

tasks:
  default:
    internal: true
    run: "once"
    cmds:
      - task: ":utils:install-remote-cmake-lib"
        vars:
          CMAKE_GEN_ARGS:
            - "-DANTLR4_INSTALL=ON"
            - "-DANTLR_BUILD_CPP_TESTS=OFF"
            - "-DCMAKE_BUILD_TYPE=Release"
            - "-DCMAKE_INSTALL_MESSAGE=LAZY"

            # Set CMP0135 so that extracted files use the current timestamp as their modification
            # timestamp, which ensures the library gets rebuilt if the extracted files change.
            - "-DCMAKE_POLICY_DEFAULT_CMP0135=NEW"
          CMAKE_SOURCE_DIR: "runtime/Cpp"
          LIB_NAME: "antlr4-runtime"
          TARBALL_SHA256: "9f18272a9b32b622835a3365f850dd1063d60f5045fb1e12ce475ae6e18a35bb"
          TARBALL_URL: "https://github.com/antlr/antlr4/archive/refs/tags/\
                        {{.G_ANTLR_VERSION}}.tar.gz"
