version: "3"

vars:
  G_ANTLR_JAR_FILE: "{{.G_DEPS_CPP_DIR}}/antlr-{{.G_ANTLR_VERSION}}-complete.jar"

tasks:
  antlr-jar:
    internal: true
    vars:
      CHECKSUM_FILE: "{{.G_DEPS_CPP_CHECKSUMS_DIR}}/antlr-jar.md5"
      OUTPUT_FILE: "{{.G_ANTLR_JAR_FILE}}"
    run: "once"
    deps:
      - task: "yscope-dev-utils:checksum:validate"
        vars:
          CHECKSUM_FILE: "{{.CHECKSUM_FILE}}"
          INCLUDE_PATTERNS:
            - "{{.OUTPUT_FILE}}"
    cmds:
      - task: "yscope-dev-utils:remote:curl"
        vars:
          FILE_SHA256: "eae2dfa119a64327444672aff63e9ec35a20180dc5b8090b7a6ab85125df4d76"
          OUTPUT_FILE: "{{.OUTPUT_FILE}}"
          URL: "https://www.antlr.org/download/antlr-{{.G_ANTLR_VERSION}}-complete.jar"

      # This command must be last
      - task: "yscope-dev-utils:checksum:compute"
        vars:
          CHECKSUM_FILE: "{{.CHECKSUM_FILE}}"
          INCLUDE_PATTERNS:
            - "{{.OUTPUT_FILE}}"
