version: "3"

includes:
  # Main project targets
  core: "core.yaml"
  log-viewer: "log-viewer.yaml"
  spider: "spider.yaml"

  # Individual library component installation tasks
  components:
    flatten: true
    taskfile: "installs/all.yaml"

  # Utils
  lock: "lock.yaml"
  utils: "utils.yaml"
  yscope-dev-utils: "../../tools/yscope-dev-utils/exports/taskfiles/utils/utils.yaml"

vars:
  # Directories
  G_DEPS_DIR: "{{.G_BUILD_DIR}}/deps"
  G_DEPS_CPP_DIR: "{{.G_DEPS_DIR}}/cpp"

  # Checksum dirs and paths
  G_DEPS_CPP_CHECKSUMS_DIR: "{{.G_DEPS_CPP_DIR}}/checksums"
  G_DEPS_CPP_CHECKSUM_FILE: "{{.G_DEPS_CPP_CHECKSUMS_DIR}}/all.md5"

  # CMake settings directory
  G_DEPS_CPP_CMAKE_SETTINGS_DIR: "{{.G_DEPS_CPP_DIR}}/cmake-settings"

  # Library names
  G_BOOST_LIB_NAME: "Boost"
  G_FMT_LIB_NAME: "fmt"
  G_GSL_LIB_NAME: "Microsoft.GSL"

  # Antlr
  G_ANTLR_VERSION: "4.13.2"
  G_ANTLR_JAR_FILE: "{{.G_DEPS_CPP_DIR}}/antlr-{{.G_ANTLR_VERSION}}-complete.jar"

tasks:
  default:
    deps:
      - "core"
      - "log-viewer"
      - "spider"

  init:
    internal: true
    run: "once"
    cmds:
      - "mkdir -p '{{.G_DEPS_DIR}}'"
      - "mkdir -p '{{.G_DEPS_CPP_DIR}}'"
      - "mkdir -p '{{.G_DEPS_CPP_CHECKSUMS_DIR}}'"
      - "mkdir -p '{{.G_DEPS_CPP_CMAKE_SETTINGS_DIR}}'"
