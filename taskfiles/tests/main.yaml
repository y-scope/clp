version: "3"

includes:
  integration: "integration.yaml"

tasks:
  rust-all:
    deps: [":toolchains:rust"]
    dir: "{{.ROOT_DIR}}"
    cmds:
      - uv run tools/scripts/localstack/start.py
      - defer: uv run tools/scripts/localstack/stop.py
      - uv run tools/scripts/localstack/create_log_ingestor_test_resources.py
      - . "$HOME/.cargo/env"
      - cargo test --all --all-features --release
